___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Black Crow AI",
  "brand": {
    "id": "github.com_october8ai",
    "displayName": "Black Crow AI",
    "thumbnail": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAGQAZADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3TUtSttKs3url8IvAA6sfQe9ecap4u1PUXYRym1g7JEcH8W6mjxdqjajrUkQb9xbExoPcfeP5/wAhWBXlYnEylJxi9D4rNs1qVajpUnaK006/8Ac7tI252LH1JzTaKK4zwgooooEFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAU5HeNtyMyn1BxTaKBm/pfi7U9OcCWU3UHdJTk/g3UV6PpupW2q2a3Nq+5DwQeqn0PvXjNb/hHVG07Wo4y37i5Ijcds/wAJ/P8AnXZhsTKMlGT0PdyrNqlKoqVV3i9Nen/AMJ3MkjO3ViSabRRXGeEFFFFAgooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKcjmN1deqkEU2igYUUUUCCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArgPGurXttrUcFrdzQosILCOQrkkn09sV39eW+NGLeJ7gf3VQf8AjoP9a68HFOpr2PbyGnGpiveV7J/oZ/8Aburf9BO7/wC/zf40f27q3/QTu/8Av83+NZ9FepyR7H2X1ej/ACL7kaH9u6t/0E7v/v8AN/jR/burf9BO7/7/ADf41n0UckewfV6P8i+5Gh/burf9BO7/AO/zf40f27q3/QTu/wDv83+NZ9FHJHsH1ej/ACL7kaH9u6t/0E7v/v8AN/jR/burf9BO7/7/ADf41n0UckewfV6P8i+5GnF4i1iFwy6lcEj+++4fkc12fhvxeNSmWyvlVLluEkXhXPpjsf515zTkdo5FdGKupBUjqDWVTDwmrWOXF5Zh8RBx5Un0aPcKKq6Zd/btMtbo8GWJWI98c/rVqvGas7M/PpxcJOL3QUUUUiQooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvLPGYx4ouvcJ/6CK9TrzPx3Fs8Qhv+ekKt+pH9K7ME/wB58j3eHpWxbXdP9DmaKKK9U+2C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"
  },
  "description": "A custom tag for interacting with the Black Crow AI JavaScript API. This tag allows Black Crow AI to score users and upload to different martech platforms.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "site_name",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY",
        "errorMessage": "Please enter your site name."
      },
      {
        "type": "REGEX",
        "args": [
          "([^{]+)"
        ],
        "errorMessage": "Please don\u0027t include any curly braces or variables in your site name."
      }
    ],
    "displayName": "Domain Name"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const encodeUriComponent = require('encodeUriComponent');


const getDomain = (siteName) => {
    let top_level_domains = ["gov", "org", "co", "com", "in", "info", "net", "uk", "af", "am", "ar", "au", "as", "az", "be", "bg", "bn", "bo", "bs", "ca", "cs", "cy", "da", "de", "dv", "el", "en", "es", "et", "eu", "fa", "fi", "fo", "fr", "gd", "gl", "gn", "gu", "he", "hi", "hr", "hu", "hy", "id", "is", "it", "jp", "ka", "kk", "km", "kn", "ko", "ks", "la", "lo", "lt", "lv", "mi", "mk", "ml", "mn", "mr", "ms", "mt", "my", "nb", "ne", "nl", "or", "pa", "pl", "pt", "rm", "ro", "ru", "sa", "sb", "sd", "si", "sk", "sl", "so", "sq", "sr", "sv", "sw", "ta", "te", "tg", "th", "tk", "tn", "tr", "ts", "tt", "uk", "ur", "uz", "vi", "xh", "yi", "zh", "zu"];
    let site_name_without_protocol = siteName.replace('http://','').replace('https://','').replace('www.', ''),
        components = site_name_without_protocol.split('.'),
        len_com = components.length,
        len_dom = top_level_domains.length;
    
    for(let j = 0; j < len_com; j++) {
        for(let i = 0; i < len_dom; i++){
            if(top_level_domains[i] == components[j]){
                components.splice(j, 1);
                j--;
            }
        }
    }

    return components.join('_');
};

const site_name = getDomain(data.site_name);

injectScript('https://init.blackcrow.ai/js/core/' + encodeUriComponent(site_name) + '.js?source=gtm&version=template');
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://init.blackcrow.ai/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 10/28/2020, 2:20:40 AM


